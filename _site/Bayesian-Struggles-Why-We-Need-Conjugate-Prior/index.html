<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>Bayesian Struggles: why we need conjugate prior &#8211; NumerairX</title> <meta name="description" content="starting with two simple examples…"> <meta name="keywords" content="statistics"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="logo.png"> <meta name="twitter:title" content="Bayesian Struggles: why we need conjugate prior"> <meta name="twitter:description" content="starting with two simple examples…"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Bayesian Struggles: why we need conjugate prior"> <meta property="og:description" content="starting with two simple examples…"> <meta property="og:url" content="//numerairX.github.io/Bayesian-Struggles-Why-We-Need-Conjugate-Prior/"> <meta property="og:site_name" content="NumerairX"> <meta property="og:image" content="//numerairX.github.io/images/logo.png"> <link rel="canonical" href="//numerairX.github.io/Bayesian-Struggles-Why-We-Need-Conjugate-Prior/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="//numerairx.github.io/feed.xml" title="NumerairX" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="//numerairX.github.io/favicon.png" /> <link rel="shortcut icon" href="//numerairX.github.io/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="//numerairX.github.io/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(//numerairX.github.io/images/unsplash-gallery-image-3.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(//numerairX.github.io/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(//numerairX.github.io/images/home.png) no-repeat;background-size: cover;} </style> </head> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true } }); </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="//numerairX.github.io" class="logo"><img src="//numerairX.github.io/images/logo.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">Bayesian Struggles: why we need conjugate prior </h1> <ul class="tags"> <li><a href="//numerairX.github.io/tags#statistics">statistics</a></li> </ul> <div class="section-line reverse"><a href="//numerairX.github.io/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <div class="share-buttons"> <a href="https://twitter.com/intent/tweet?text=//numerairX.github.io/Bayesian-Struggles-Why-We-Need-Conjugate-Prior/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=//numerairX.github.io/Bayesian-Struggles-Why-We-Need-Conjugate-Prior/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=//numerairX.github.io/Bayesian-Struggles-Why-We-Need-Conjugate-Prior/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> </div> <a href="../posts.html" title="posts" class="posts-menu-icon"></a> <a title="projects" class="projects-menu-icon"> <span></span> </a> <div class="inner-post content"> <div class="date-highlight">22 Dec 2018</div> <p>I want to start this first post of the series of Bayesian stats with this meme. <a href="//numerairX.github.io/images/bayesfun.png"><img src="//numerairX.github.io/images/bayesfun.png" alt="bayesian meme" /></a><br /> (image from <a href="https://www2.isye.gatech.edu/~brani/isyebayes/jokes.html">Bayesian Fun</a>)</p> <p>It is also important to make sure my dear reader(s) knows that I am by all means not an expert in statistics (let me know if u found mistakes!). I came from an applied math background but had no interest in taking stats in college (thought it was easy and too formulaic at that time, naive!!). So I am almost completely self-taught in this subject and prone to interpret things in a familiar way to help me understand.</p> <p>However, I think because I had (a lot of) struggles, I can share better how the logic flows to overcome them.</p> <h5 id="how-did-we-come-to-realize-that-we-might-need-something-called-conjugate-prior">How did we come to realize that we might need something called conjugate prior?</h5> <table> <tbody> <tr> <td>Consider the example given by Bayes himself in his 1763 paper: let us roll a ball along unit interval $[0,1]$ with uniform probability of stopping anywhere in between. This ball finally stopped at distance $\theta$ and we then throw this ball for $n$ times. Denote the number of times ball stops before reaching $\theta$ as $x$, what can we learn about $\theta$ now (aka what is $p(\theta</td> <td>x)$)?</td> </tr> </tbody> </table> <table> <tbody> <tr> <td>In this case our prior is no longer just our <em>‘belief’</em> but a physics fact. We understand that $p(\theta)$ is 1 since it follows uniform distribution, and $p(x</td> <td>\theta)$ is just binomial probability density function.</td> </tr> </tbody> </table> <table> <tbody> <tr> <td>$p(x</td> <td>\theta) = \int_{0}^{1} \theta^x (1-\theta)^{n-x} d\theta$</td> </tr> </tbody> </table> <p>​ $=\frac{1^{k+1}(1-1)^{n-k}}{k+1}-\frac{0^{k+1}(1-0)^{n-k}}{k+1}+\frac{n-k}{k+1}\int_0^1 p^{k+1}(1-p)^{n-k-1}\$</p> <p>​ $= …$ keep doing integration by parts</p> <p>​ $= \frac{x!(n-x)!}{(n+1)!}$</p> <p>which verifies to be beta distribution of $\alpha = x+1, \beta = n-x+1$. With all the elements known, by Baye’s theorem $p(\theta|x) \propto p(x|\theta)p(\theta) $, our posterior follows beta distribution of the above parameters. However, if instead we take $Beta(\alpha,\beta)$ as our prior, our posterior then follows: $p(x|\theta)p(\theta) \propto \theta^x(1-\theta)^{n-x}\theta^{\alpha-1}(1-\theta)^{\beta-1} \sim Beta(\alpha+x,\beta+n-x)$.</p> <p><em>highlight</em>:</p> <ol> <li> <p>our posterior has the same form as prior which makes it easy to update</p> </li> <li> <p>prior now also have explanation power:</p> <p>while we roll the ball, each time it stops before $\theta$, it corresponds to the probability density of binomial as in increase of successful trail (aka $x+1$), so imagine if we were live-recording the rolling, we would add 1 to $\alpha$. If it exceeds the line, we would add 1 to $\beta$. Very intuitive.</p> </li> </ol> <h4 id="did-that-really-make-much-of-a-difference-yes-if-we-bring-complicated-integrals-in-the-house">Did that really make much of a difference? Yes if we bring complicated integrals in the house!</h4> <p>let’s imagine a slightly more complicated case, where you are trying to infer the parameters of your dataset, which you believe to follow normal distribution. You don’t get nice property like $p(\theta)$ just equals to 1 and needs to do<br /> $\int_{- \infty}^{\infty} \frac{1}{\sqrt{2\pi\sigma_0^2}} e^{\frac{-(\mu-\mu_0)^2}{2\sigma_0^2}} * \frac{1}{\sqrt{2\pi\sigma^2}} e^{\frac{-(x-\mu)^2}{2\sigma^2}} d\mu$ every time you update. This is actually why most times we want find nice conjugate priors to avoid computing high dimensional integration. The benefits will came clear after the below explanation.</p> <blockquote> <p>Consider i.i.d sample $X = (x_1,x_2, …, x_n)$ are drawn from distribution $N(\mu,\sigma^2)$ with <strong>$\mu$ and $\sigma^2$ random</strong>. Let $\tau = \frac{1}{\sigma^2}$, it is suffice to have parameter set $\theta = (\mu, \tau)$.</p> </blockquote> <h5 id="our-goal-find-pxmutau">our goal: find $p(x|\mu,\tau)$</h5> <h5 id="--tricky-part-find-pmutau">-&gt; Tricky part: find $p(\mu,\tau)$</h5> <p>Similarly to the problem of only $\sigma^2$ fixed, consider a gamma prior, $\tau \propto \Gamma(\alpha,\beta) $, and we use the parametrization that PDF is $ \frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-x\beta}$ then for $\sigma^2$ is (obviously) an inverse gamma distribution, aka $\sigma^2 \propto IG(\alpha,\beta)$.</p> <p>However, I did struggle a while understanding what $\mu$ should be because it seems independent of $\sigma^2$. But if $\mu$ and $\sigma^2$ are independent of each other, posterior won’t be in inverse gamma format so we end up having nothing handy. Later from the wisdom of my professor, he made that $\mu|\tau \propto N(v, \frac{1}{k\tau})$ for $v, k$ being some real number and of course $k&gt;0$. The reason behind is given both conditioned on $X$ , $\mu$ and $\sigma^2$ should be dependent.</p> <p>The full prior density $p(\tau,\mu)$ is then $p(\tau)p(\mu|\tau) = \frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha-1} exp(-x\beta) \sqrt{\frac{k\tau}{2\pi}} exp({-\frac{k\tau}{2}(\mu-v)^2}) $ <strong>(1)</strong></p> <table> <tbody> <tr> <td>and posterior $p(\mu,\tau</td> <td>x) = $<strong>(1)</strong> * $(\frac{\tau}{2\pi})^{\frac{n}{2}} exp({\frac{-\tau}{2}}\sum_{i}(x_i-\mu)^2)$</td> </tr> </tbody> </table> <p>Omitting some merging and substituting tricks that nobody wants to see, we come down to:</p> <table> <tbody> <tr> <td>$p(\mu,\tau</td> <td>x) \propto \tau^{\alpha’-1/2} exp(-\tau(\beta’ + \frac{k’}{2}(\mu-v’)^2))$</td> </tr> </tbody> </table> <p>$\alpha’ = \alpha + \frac{n}{2}$</p> <p>$\beta’ = \beta + \frac{1}{2} \frac{nk}{n+k}(\bar{x}-v)^2 + \frac{1}{2} \sum_{i} (x_i-x)^2$</p> <p>$k’ = k+n’$</p> <p>$v’ = \frac{kv+n\bar{x}}{k+n}$</p> <p>leaves only four simple algebra to maintain at each update.</p> <p>To end this article, I will share a fun read, <a href="http://www.stats.org.uk/priors/noninformative/YangBerger1998.pdf">A Catalog of Noninformative Priors</a> I found a while ago.</p> <br> <a href="https://twitter.com/intent/tweet?text=//numerairX.github.io/Bayesian-Struggles-Why-We-Need-Conjugate-Prior/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=//numerairX.github.io/Bayesian-Struggles-Why-We-Need-Conjugate-Prior/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=//numerairX.github.io/Bayesian-Struggles-Why-We-Need-Conjugate-Prior/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> <nav class="pagination"> <a href="//numerairX.github.io/paper-recommendation/" class="pagination_pager" title="2018 Paper and Book Reading List ">previous</a> <a href="#" class="pagination_pager disabled">next</a> </nav> </div> </div> <!-- JS --> <script src="//numerairX.github.io/assets/js/main.min.js"></script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(http://taylantatli.me/Halve/images/halve-home-image.png) center center no-repeat;"> <a href="google.com" class="inactive" target="_blank" rel="nofollow external"> <span> Coming soon.. what do you want to see? <br><em>in progress</em> </span> </a> </li> </ul> </div> </body> </html>
